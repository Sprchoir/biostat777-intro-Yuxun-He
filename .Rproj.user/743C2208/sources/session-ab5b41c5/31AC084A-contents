---
title: "Example analysis"
bibliography: references.bib
format:
  html:
    theme: cosmo
    toc: true
    page-layout: article
---

## Background

**Question:** How do penguin body size metrics (e.g. flipper length and body mass) vary across species and sex?

**Intended audience:** Readers who want a quick, visual overview of species-level differences—students learning data viz and anyone curious about Antarctic penguins.

**Dataset:** This analysis uses the `palmerpenguins` dataset @palmerpenguins, which provides an alternative to the classic “iris” dataset for demonstrating tidy data principles.

::: {.column-margin}
This dataset contains **344 penguins** from the Palmer Archipelago, with measurements such as flipper length, bill size, and body mass.
:::

The dataset comes from the **palmerpenguins** R package by Allison Horst, Alison Hill, and Kristen Gorman [@palmerpenguins; @palmerpenguins_web].  
- **Overview:** [palmerpenguins vignette](https://allisonhorst.github.io/palmerpenguins/) [@palmerpenguins_web]  
- **CRAN Reference Manual (data dictionary):** [palmerpenguins.pdf](https://cran.r-project.org/web/packages/palmerpenguins/palmerpenguins.pdf) [@palmerpenguins]  
- **Alternative data dictionary (web article):** [RPubs data dictionary](https://rpubs.com/rich_i/dd_pp) [@rpubs_dictionary]

::: callout-note
**Image requirement.**\
Below we include an external image from the *palmerpenguins* artwork collection (credit: **Allison Horst**).\
If desired, you can download it and save locally under `images/`.\
:::

![](https://allisonhorst.github.io/palmerpenguins/reference/figures/lter_penguins.png){fig-align="center" fig-cap="Palmer Archipelago penguins. Artwork by @allison_horst." width="70%"}

## Data Analysis

### Load packages and dataset

```{r}
#| message: false
library(dplyr)
library(ggplot2)
library(tidyr)
library(palmerpenguins)

peng <- penguins
head(peng)
```

### Data Wrangling

We first clean and summarize the dataset by removing missing values and grouping by species and sex.
We cite packages used for wrangling and plots (@dplyr; @ggplot2).

```{r}
peng_clean <-
  peng %>%
  drop_na(species, sex, body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm) %>% # tidyr::drop_na
  mutate(
    body_mass_kg = body_mass_g / 1000,
    sex = factor(sex, levels = c("female", "male"))
  ) %>%                             
  select(species, island, sex, bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, body_mass_kg) %>% 
  arrange(species, sex) %>%     
  group_by(species, sex) %>%     
  summarise(
    n = dplyr::n(),
    mean_mass_kg = mean(body_mass_kg, na.rm = TRUE),
    mean_flipper = mean(flipper_length_mm, na.rm = TRUE),
    .groups = "drop"
  )                                   

peng_long <-
  peng %>%
  drop_na(body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm) %>%
  pivot_longer(
    cols = c(body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm),
    names_to = "measure", values_to = "value"
  )                                      
```

::: callout-tip
**Tip.** If your render fails, make sure you’ve installed the packages: install.packages(c("palmerpenguins","dplyr","tidyr","ggplot2")).
:::

### Plot 1 — Flipper vs. body mass (faceted scatter)

```{r}
#| warning: false
#| message: false
ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ species, nrow = 1) +
  labs(
    title = "Penguin body mass increases with flipper length",
    subtitle = "Linear trends by species | Palmer Archipelago (Antarctica)",
    x = "Flipper length (mm)",
    y = "Body mass (g)",
    caption = "Data: palmerpenguins package"
  ) +
  theme_minimal(base_size = 12)
```

### Plot 2 — Body mass by species & sex (boxplot)

```{r}
peng_box <- penguins %>% tidyr::drop_na(species, sex, body_mass_g)

ggplot(peng_box, aes(x = species, y = body_mass_g, fill = sex)) +
  geom_boxplot(outlier.alpha = 0.5) +
  labs(
    title = "Body mass distribution by species and sex",
    subtitle = "Heavier Gentoo on average; sex differences visible within species",
    x = "Species",
    y = "Body mass (g)",
    caption = "Data: palmerpenguins"
  ) +
  theme_minimal(base_size = 12)
```

### Plot 3 — Mean size summary (column chart)

```{r}
ggplot(peng_clean, aes(x = species, y = mean_flipper, fill = sex)) +
  geom_col(position = "dodge") +
  labs(
    title = "Average flipper length by species and sex",
    subtitle = "Summary after grouping and summarising",
    x = "Species",
    y = "Mean flipper length (mm)",
    caption = "Computed from cleaned data"
  ) +
  theme_minimal(base_size = 12)
```

### Result Summary

Across the three penguin species, **body mass shows a clear positive relationship with flipper length**, as visualized by the linear trends in the faceted scatterplot. Gentoo penguins are generally the heaviest and have the longest flippers, while Adelie and Chinstrap penguins are smaller in both dimensions. The boxplot reveals that males tend to be heavier than females within each species, indicating **a consistent sex-based difference in body size**. The bar chart further confirms that **Gentoo penguins have the largest mean flipper length overall**. Together, these findings highlight distinct morphological variations across species and sex, reflecting adaptations to their respective ecological niches.

Together, these findings highlight **distinct morphological differences across species and sex**, reflecting evolutionary adaptations to their ecological environments.

### Function Checklist

-   Data wrangling with `dplyr` and `tidyr`:
    -   `drop_na()`
    -   `mutate()`
    -   `select()`
    -   `arrange()`
    -   `group_by()`
    -   `summarise()`
    -   `pivot_longer()`
    -   `n()`
-   Data visualization with `ggplot2`:
    -   `ggplot()`
    -   `geom_point()`
    -   `geom_smooth()`
    -   `facet_wrap()`
    -   `geom_boxplot()`
    -   `geom_col()`
    -   `labs()`
    -   `theme_minimal()`
    -   `aes()`
