{"title":"Example analysis","markdown":{"yaml":{"title":"Example analysis","bibliography":"references.bib","format":{"html":{"theme":"cosmo","toc":true,"page-layout":"article"}}},"headingText":"Background","containsRefs":false,"markdown":"\n\n\n**Question:** How do penguin body size metrics (e.g. flipper length and body mass) vary across species and sex?\n\n**Intended audience:** Readers who want a quick, visual overview of species-level differences—students learning data viz and anyone curious about Antarctic penguins.\n\n**Dataset:** This analysis uses the `palmerpenguins` dataset @palmerpenguins, which provides an alternative to the classic “iris” dataset for demonstrating tidy data principles.\n\n::: {.column-margin}\nThis dataset contains **344 penguins** from the Palmer Archipelago, with measurements such as flipper length, bill size, and body mass.\n:::\n\nThe dataset comes from the **palmerpenguins** R package by Allison Horst, Alison Hill, and Kristen Gorman [@palmerpenguins; @palmerpenguins_web].  \n- **Overview:** [palmerpenguins vignette](https://allisonhorst.github.io/palmerpenguins/) [@palmerpenguins_web]  \n- **CRAN Reference Manual (data dictionary):** [palmerpenguins.pdf](https://cran.r-project.org/web/packages/palmerpenguins/palmerpenguins.pdf) [@palmerpenguins]  \n- **Alternative data dictionary (web article):** [RPubs data dictionary](https://rpubs.com/rich_i/dd_pp) [@rpubs_dictionary]\n\n::: callout-note\n**Image requirement.**\\\nBelow we include an external image from the *palmerpenguins* artwork collection (credit: **Allison Horst**).\\\nIf desired, you can download it and save locally under `images/`.\\\n:::\n\n![](https://allisonhorst.github.io/palmerpenguins/reference/figures/lter_penguins.png){fig-align=\"center\" fig-cap=\"Palmer Archipelago penguins. Artwork by @allison_horst.\" width=\"70%\"}\n\n## Data Analysis\n\n### Load packages and dataset\n\n```{r}\n#| message: false\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(palmerpenguins)\n\npeng <- penguins\nhead(peng)\n```\n\n### Data Wrangling\n\nWe first clean and summarize the dataset by removing missing values and grouping by species and sex.\nWe cite packages used for wrangling and plots (@dplyr; @ggplot2).\n\n```{r}\npeng_clean <-\n  peng %>%\n  drop_na(species, sex, body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm) %>% # tidyr::drop_na\n  mutate(\n    body_mass_kg = body_mass_g / 1000,\n    sex = factor(sex, levels = c(\"female\", \"male\"))\n  ) %>%                             \n  select(species, island, sex, bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, body_mass_kg) %>% \n  arrange(species, sex) %>%     \n  group_by(species, sex) %>%     \n  summarise(\n    n = dplyr::n(),\n    mean_mass_kg = mean(body_mass_kg, na.rm = TRUE),\n    mean_flipper = mean(flipper_length_mm, na.rm = TRUE),\n    .groups = \"drop\"\n  )                                   \n\npeng_long <-\n  peng %>%\n  drop_na(body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm) %>%\n  pivot_longer(\n    cols = c(body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm),\n    names_to = \"measure\", values_to = \"value\"\n  )                                      \n```\n\n::: callout-tip\n**Tip.** If your render fails, make sure you’ve installed the packages: install.packages(c(\"palmerpenguins\",\"dplyr\",\"tidyr\",\"ggplot2\")).\n:::\n\n### Plot 1 — Flipper vs. body mass (faceted scatter)\n\n```{r}\n#| warning: false\n#| message: false\nggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +\n  geom_point(alpha = 0.7) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  facet_wrap(~ species, nrow = 1) +\n  labs(\n    title = \"Penguin body mass increases with flipper length\",\n    subtitle = \"Linear trends by species | Palmer Archipelago (Antarctica)\",\n    x = \"Flipper length (mm)\",\n    y = \"Body mass (g)\",\n    caption = \"Data: palmerpenguins package\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n### Plot 2 — Body mass by species & sex (boxplot)\n\n```{r}\npeng_box <- penguins %>% tidyr::drop_na(species, sex, body_mass_g)\n\nggplot(peng_box, aes(x = species, y = body_mass_g, fill = sex)) +\n  geom_boxplot(outlier.alpha = 0.5) +\n  labs(\n    title = \"Body mass distribution by species and sex\",\n    subtitle = \"Heavier Gentoo on average; sex differences visible within species\",\n    x = \"Species\",\n    y = \"Body mass (g)\",\n    caption = \"Data: palmerpenguins\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n### Plot 3 — Mean size summary (column chart)\n\n```{r}\nggplot(peng_clean, aes(x = species, y = mean_flipper, fill = sex)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Average flipper length by species and sex\",\n    subtitle = \"Summary after grouping and summarising\",\n    x = \"Species\",\n    y = \"Mean flipper length (mm)\",\n    caption = \"Computed from cleaned data\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n### Result Summary\n\nAcross the three penguin species, **body mass shows a clear positive relationship with flipper length**, as visualized by the linear trends in the faceted scatterplot. Gentoo penguins are generally the heaviest and have the longest flippers, while Adelie and Chinstrap penguins are smaller in both dimensions. The boxplot reveals that males tend to be heavier than females within each species, indicating **a consistent sex-based difference in body size**. The bar chart further confirms that **Gentoo penguins have the largest mean flipper length overall**. Together, these findings highlight distinct morphological variations across species and sex, reflecting adaptations to their respective ecological niches.\n\nTogether, these findings highlight **distinct morphological differences across species and sex**, reflecting evolutionary adaptations to their ecological environments.\n\n### Function Checklist\n\n-   Data wrangling with `dplyr` and `tidyr`:\n    -   `drop_na()`\n    -   `mutate()`\n    -   `select()`\n    -   `arrange()`\n    -   `group_by()`\n    -   `summarise()`\n    -   `pivot_longer()`\n    -   `n()`\n-   Data visualization with `ggplot2`:\n    -   `ggplot()`\n    -   `geom_point()`\n    -   `geom_smooth()`\n    -   `facet_wrap()`\n    -   `geom_boxplot()`\n    -   `geom_col()`\n    -   `labs()`\n    -   `theme_minimal()`\n    -   `aes()`\n","srcMarkdownNoYaml":"\n\n## Background\n\n**Question:** How do penguin body size metrics (e.g. flipper length and body mass) vary across species and sex?\n\n**Intended audience:** Readers who want a quick, visual overview of species-level differences—students learning data viz and anyone curious about Antarctic penguins.\n\n**Dataset:** This analysis uses the `palmerpenguins` dataset @palmerpenguins, which provides an alternative to the classic “iris” dataset for demonstrating tidy data principles.\n\n::: {.column-margin}\nThis dataset contains **344 penguins** from the Palmer Archipelago, with measurements such as flipper length, bill size, and body mass.\n:::\n\nThe dataset comes from the **palmerpenguins** R package by Allison Horst, Alison Hill, and Kristen Gorman [@palmerpenguins; @palmerpenguins_web].  \n- **Overview:** [palmerpenguins vignette](https://allisonhorst.github.io/palmerpenguins/) [@palmerpenguins_web]  \n- **CRAN Reference Manual (data dictionary):** [palmerpenguins.pdf](https://cran.r-project.org/web/packages/palmerpenguins/palmerpenguins.pdf) [@palmerpenguins]  \n- **Alternative data dictionary (web article):** [RPubs data dictionary](https://rpubs.com/rich_i/dd_pp) [@rpubs_dictionary]\n\n::: callout-note\n**Image requirement.**\\\nBelow we include an external image from the *palmerpenguins* artwork collection (credit: **Allison Horst**).\\\nIf desired, you can download it and save locally under `images/`.\\\n:::\n\n![](https://allisonhorst.github.io/palmerpenguins/reference/figures/lter_penguins.png){fig-align=\"center\" fig-cap=\"Palmer Archipelago penguins. Artwork by @allison_horst.\" width=\"70%\"}\n\n## Data Analysis\n\n### Load packages and dataset\n\n```{r}\n#| message: false\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(palmerpenguins)\n\npeng <- penguins\nhead(peng)\n```\n\n### Data Wrangling\n\nWe first clean and summarize the dataset by removing missing values and grouping by species and sex.\nWe cite packages used for wrangling and plots (@dplyr; @ggplot2).\n\n```{r}\npeng_clean <-\n  peng %>%\n  drop_na(species, sex, body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm) %>% # tidyr::drop_na\n  mutate(\n    body_mass_kg = body_mass_g / 1000,\n    sex = factor(sex, levels = c(\"female\", \"male\"))\n  ) %>%                             \n  select(species, island, sex, bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, body_mass_kg) %>% \n  arrange(species, sex) %>%     \n  group_by(species, sex) %>%     \n  summarise(\n    n = dplyr::n(),\n    mean_mass_kg = mean(body_mass_kg, na.rm = TRUE),\n    mean_flipper = mean(flipper_length_mm, na.rm = TRUE),\n    .groups = \"drop\"\n  )                                   \n\npeng_long <-\n  peng %>%\n  drop_na(body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm) %>%\n  pivot_longer(\n    cols = c(body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm),\n    names_to = \"measure\", values_to = \"value\"\n  )                                      \n```\n\n::: callout-tip\n**Tip.** If your render fails, make sure you’ve installed the packages: install.packages(c(\"palmerpenguins\",\"dplyr\",\"tidyr\",\"ggplot2\")).\n:::\n\n### Plot 1 — Flipper vs. body mass (faceted scatter)\n\n```{r}\n#| warning: false\n#| message: false\nggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +\n  geom_point(alpha = 0.7) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  facet_wrap(~ species, nrow = 1) +\n  labs(\n    title = \"Penguin body mass increases with flipper length\",\n    subtitle = \"Linear trends by species | Palmer Archipelago (Antarctica)\",\n    x = \"Flipper length (mm)\",\n    y = \"Body mass (g)\",\n    caption = \"Data: palmerpenguins package\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n### Plot 2 — Body mass by species & sex (boxplot)\n\n```{r}\npeng_box <- penguins %>% tidyr::drop_na(species, sex, body_mass_g)\n\nggplot(peng_box, aes(x = species, y = body_mass_g, fill = sex)) +\n  geom_boxplot(outlier.alpha = 0.5) +\n  labs(\n    title = \"Body mass distribution by species and sex\",\n    subtitle = \"Heavier Gentoo on average; sex differences visible within species\",\n    x = \"Species\",\n    y = \"Body mass (g)\",\n    caption = \"Data: palmerpenguins\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n### Plot 3 — Mean size summary (column chart)\n\n```{r}\nggplot(peng_clean, aes(x = species, y = mean_flipper, fill = sex)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Average flipper length by species and sex\",\n    subtitle = \"Summary after grouping and summarising\",\n    x = \"Species\",\n    y = \"Mean flipper length (mm)\",\n    caption = \"Computed from cleaned data\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n### Result Summary\n\nAcross the three penguin species, **body mass shows a clear positive relationship with flipper length**, as visualized by the linear trends in the faceted scatterplot. Gentoo penguins are generally the heaviest and have the longest flippers, while Adelie and Chinstrap penguins are smaller in both dimensions. The boxplot reveals that males tend to be heavier than females within each species, indicating **a consistent sex-based difference in body size**. The bar chart further confirms that **Gentoo penguins have the largest mean flipper length overall**. Together, these findings highlight distinct morphological variations across species and sex, reflecting adaptations to their respective ecological niches.\n\nTogether, these findings highlight **distinct morphological differences across species and sex**, reflecting evolutionary adaptations to their ecological environments.\n\n### Function Checklist\n\n-   Data wrangling with `dplyr` and `tidyr`:\n    -   `drop_na()`\n    -   `mutate()`\n    -   `select()`\n    -   `arrange()`\n    -   `group_by()`\n    -   `summarise()`\n    -   `pivot_longer()`\n    -   `n()`\n-   Data visualization with `ggplot2`:\n    -   `ggplot()`\n    -   `geom_point()`\n    -   `geom_smooth()`\n    -   `facet_wrap()`\n    -   `geom_boxplot()`\n    -   `geom_col()`\n    -   `labs()`\n    -   `theme_minimal()`\n    -   `aes()`\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"example.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","theme":["cosmo","brand"],"title":"Example analysis","bibliography":["references.bib"],"page-layout":"article"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}