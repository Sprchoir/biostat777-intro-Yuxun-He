{
  "hash": "5aafd0fa9d3b62e6a11f87ead63d5bc2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Example analysis\"\nbibliography: references.bib\nformat:\n  html:\n    theme: cosmo\n    toc: true\n    page-layout: article\n---\n\n\n\n\n## Background\n\n**Question:** How do penguin body size metrics (e.g. flipper length and body mass) vary across species and sex?\n\n**Intended audience:** Readers who want a quick, visual overview of species-level differences—students learning data viz and anyone curious about Antarctic penguins.\n\n**Dataset:** This analysis uses the `palmerpenguins` dataset @palmerpenguins, which provides an alternative to the classic “iris” dataset for demonstrating tidy data principles.\n\n::: {.column-margin}\nThis dataset contains **344 penguins** from the Palmer Archipelago, with measurements such as flipper length, bill size, and body mass.\n:::\n\nThe dataset comes from the **palmerpenguins** R package by Allison Horst, Alison Hill, and Kristen Gorman [@palmerpenguins; @palmerpenguins_web].  \n- **Overview:** [palmerpenguins vignette](https://allisonhorst.github.io/palmerpenguins/) [@palmerpenguins_web]  \n- **CRAN Reference Manual (data dictionary):** [palmerpenguins.pdf](https://cran.r-project.org/web/packages/palmerpenguins/palmerpenguins.pdf) [@palmerpenguins]  \n- **Alternative data dictionary (web article):** [RPubs data dictionary](https://rpubs.com/rich_i/dd_pp) [@rpubs_dictionary]\n\n::: callout-note\n**Image requirement.**\\\nBelow we include an external image from the *palmerpenguins* artwork collection (credit: **Allison Horst**).\\\nIf desired, you can download it and save locally under `images/`.\\\n:::\n\n![](https://allisonhorst.github.io/palmerpenguins/reference/figures/lter_penguins.png){fig-align=\"center\" fig-cap=\"Palmer Archipelago penguins. Artwork by @allison_horst.\" width=\"70%\"}\n\n## Data Analysis\n\n### Load packages and dataset\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(palmerpenguins)\n\npeng <- penguins\nhead(peng)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n3 Adelie  Torgersen           40.3          18                 195        3250\n4 Adelie  Torgersen           NA            NA                  NA          NA\n5 Adelie  Torgersen           36.7          19.3               193        3450\n6 Adelie  Torgersen           39.3          20.6               190        3650\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n\n### Data Wrangling\n\nWe first clean and summarize the dataset by removing missing values and grouping by species and sex.\nWe cite packages used for wrangling and plots (@dplyr; @ggplot2).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npeng_clean <-\n  peng %>%\n  drop_na(species, sex, body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm) %>% # tidyr::drop_na\n  mutate(\n    body_mass_kg = body_mass_g / 1000,\n    sex = factor(sex, levels = c(\"female\", \"male\"))\n  ) %>%                             \n  select(species, island, sex, bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, body_mass_kg) %>% \n  arrange(species, sex) %>%     \n  group_by(species, sex) %>%     \n  summarise(\n    n = dplyr::n(),\n    mean_mass_kg = mean(body_mass_kg, na.rm = TRUE),\n    mean_flipper = mean(flipper_length_mm, na.rm = TRUE),\n    .groups = \"drop\"\n  )                                   \n\npeng_long <-\n  peng %>%\n  drop_na(body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm) %>%\n  pivot_longer(\n    cols = c(body_mass_g, flipper_length_mm, bill_length_mm, bill_depth_mm),\n    names_to = \"measure\", values_to = \"value\"\n  )                                      \n```\n:::\n\n\n\n\n::: callout-tip\n**Tip.** If your render fails, make sure you’ve installed the packages: install.packages(c(\"palmerpenguins\",\"dplyr\",\"tidyr\",\"ggplot2\")).\n:::\n\n### Plot 1 — Flipper vs. body mass (faceted scatter)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +\n  geom_point(alpha = 0.7) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  facet_wrap(~ species, nrow = 1) +\n  labs(\n    title = \"Penguin body mass increases with flipper length\",\n    subtitle = \"Linear trends by species | Palmer Archipelago (Antarctica)\",\n    x = \"Flipper length (mm)\",\n    y = \"Body mass (g)\",\n    caption = \"Data: palmerpenguins package\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n::: {.cell-output-display}\n![](example_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n### Plot 2 — Body mass by species & sex (boxplot)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npeng_box <- penguins %>% tidyr::drop_na(species, sex, body_mass_g)\n\nggplot(peng_box, aes(x = species, y = body_mass_g, fill = sex)) +\n  geom_boxplot(outlier.alpha = 0.5) +\n  labs(\n    title = \"Body mass distribution by species and sex\",\n    subtitle = \"Heavier Gentoo on average; sex differences visible within species\",\n    x = \"Species\",\n    y = \"Body mass (g)\",\n    caption = \"Data: palmerpenguins\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n::: {.cell-output-display}\n![](example_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n### Plot 3 — Mean size summary (column chart)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(peng_clean, aes(x = species, y = mean_flipper, fill = sex)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"Average flipper length by species and sex\",\n    subtitle = \"Summary after grouping and summarising\",\n    x = \"Species\",\n    y = \"Mean flipper length (mm)\",\n    caption = \"Computed from cleaned data\"\n  ) +\n  theme_minimal(base_size = 12)\n```\n\n::: {.cell-output-display}\n![](example_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n### Result Summary\n\nAcross the three penguin species, **body mass shows a clear positive relationship with flipper length**, as visualized by the linear trends in the faceted scatterplot. Gentoo penguins are generally the heaviest and have the longest flippers, while Adelie and Chinstrap penguins are smaller in both dimensions. The boxplot reveals that males tend to be heavier than females within each species, indicating **a consistent sex-based difference in body size**. The bar chart further confirms that **Gentoo penguins have the largest mean flipper length overall**. Together, these findings highlight distinct morphological variations across species and sex, reflecting adaptations to their respective ecological niches.\n\nTogether, these findings highlight **distinct morphological differences across species and sex**, reflecting evolutionary adaptations to their ecological environments.\n\n### Function Checklist\n\n-   Data wrangling with `dplyr` and `tidyr`:\n    -   `drop_na()`\n    -   `mutate()`\n    -   `select()`\n    -   `arrange()`\n    -   `group_by()`\n    -   `summarise()`\n    -   `pivot_longer()`\n    -   `n()`\n-   Data visualization with `ggplot2`:\n    -   `ggplot()`\n    -   `geom_point()`\n    -   `geom_smooth()`\n    -   `facet_wrap()`\n    -   `geom_boxplot()`\n    -   `geom_col()`\n    -   `labs()`\n    -   `theme_minimal()`\n    -   `aes()`\n",
    "supporting": [
      "example_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}